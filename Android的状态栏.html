<!DOCTYPE html>
<html lang="zh_cn">
<head>
        <title>iknockdoor-Android的状态栏</title>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <link rel="stylesheet" type="text/css" href="http://www.iknockdoor.com/theme/css/org.css" />
        <link rel="stylesheet" type="text/css" href="http://www.iknockdoor.com/theme/css/custom.css" />
        <link href="http://www.iknockdoor.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="iknockdoor Full Atom Feed" />


<script>var _gaq=[['_setAccount','UA-103057848-1'],['_trackPageview']];(function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];g.src='//www.google-analytics.com/ga.js';s.parentNode.insertBefore(g,s)}(document,'script'))</script>
        <!-- mathjax config similar to math.stackexchange -->
	<script type="text/x-mathjax-config">
	  MathJax.Hub.Config({
	  jax: ["input/TeX", "output/HTML-CSS"],
	  tex2jax: {
	  inlineMath: [ ['$', '$'] ],
	  displayMath: [ ['$$', '$$']],
	  processEscapes: true,
	  skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
	  },
	  messageStyle: "none",
	  "HTML-CSS": { preferredFont: "TeX", availableFonts: ["STIX","TeX"] }
	  });
	</script>
</head>

<body id="index" class="home">
  <div id="banner"><div id="banner-inside">
      <nav id="menu">
      <header id="site_name">
                iknockdoor
        </header><!-- /#banner -->
          <ul>
            <li><a href="{SITEURL}/index.html">index</a></li>
            <li><a href="{SITEURL}/categories.html">categories</a></li>
            <li><a href="{SITEURL}/tags.html">tags</a></li>
            <li><a href="{SITEURL}/archives.html">archives</a></li>
      </ul></nav><!-- /#menu -->
  </div></div>
  <div id="content">
<section id="content" class="body">
  <header>
    <h2 class="entry-title">
      <a href="http://www.iknockdoor.com/Android的状态栏.html" rel="bookmark"
         title="Permalink to Android的状态栏">Android的状态栏</a></h2>
 
  </header>
  <footer class="post-info">
    <time class="published" datetime="2019-07-29T00:00:00+08:00">
      一 29 七月 2019
    </time>
  </footer><!-- /.post-info -->
  <div class="entry-content">
    <div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Android的statusbar在不同版本中的区别能力</h2>
<div class="outline-text-2" id="text-1">
</div><div id="outline-container-sec-1-1" class="outline-3">
<h3 id="sec-1-1"><span class="section-number-3">1.1</span> Android 4.4(API 19)</h3>
<div class="outline-text-3" id="text-1-1">
<p>
从Android 4.4开始，Android开始支持windowTranslucentStatus样式属性，即支持状态栏的透明。那这个功能有什么用呢？
</p>
<ol class="org-ol">
<li>对于全屏的应用，APP内容可以显示在状态栏下面，获得更大的显示面积，同时又不受状态栏遮挡，因为状态栏是透明的，像一个梦层盖在上面。
</li>
<li>即使不是全屏的应用，我们也可以利用这一特性，通过透明状态栏底下的内容颜色来调整状态的栏的颜色，从而避免栏4.4以下Android都是黑漆漆的单调的状态栏，带来更好的视觉体验。
</li>
</ol>
<p>
那么透明状态栏这个特性在使用中是否存在什么问题呢？有的
</p>
<ol class="org-ol">
<li>背景色如果太浅，状态栏上的文字和图标可能会看不清楚。4.4的透明状态栏不是完全透明的，会有一个蒙层的效果，因此不会出现这个问题。
</li>
<li>由于整个APP内容是延伸到状态栏下面的，因此对view的高度计算会有影响，需要padding出状态栏的这部分高度，如果处理不好，可能会导致布局在显示时抖动，上下移位等问题。因此通常在使用
windowTranslucentStatus样式时会配合设置根布局的
SYSTEM<sub>UI</sub><sub>FLAG</sub><sub>LAYOUT</sub><sub>FULLSCREEN和SYSTEM</sub><sub>UI</sub><sub>FLAG</sub><sub>LAYOUT</sub><sub>STABLE以</sub>
及使用fitSystemWindows()方法。详见：<a href="https://developer.android.com/training/system-ui/status">https://developer.android.com/training/system-ui/status</a>
</li>
<li>正如前面所说，透明状态栏是个蒙层的效果，如果想要纯色，状态栏和
toolbar或者和内容背景色一致，浑然一体的效果，透明状态栏就无能为力了，因此才有了5.0和6.0的一些特性。
</li>
<li>如果不是全屏应用，只是想调整状态栏颜色以取得更好的视觉效果，使用
4.4的这个方法还需要处理布局中状态栏高度的问题，整个解决方案会比较复杂。
</li>
</ol>
</div>
</div>
<div id="outline-container-sec-1-2" class="outline-3">
<h3 id="sec-1-2"><span class="section-number-3">1.2</span> Android 5.0 (API 21)</h3>
<div class="outline-text-3" id="text-1-2">
<p>
继续前面4.4遇到的这些问题，对于全屏APP的需求场景，5.0和4.4的处理没有什么区别。对于只是想修改状态栏颜色的需求，5.0支持了直接设置状态栏颜色功能，同时配套支持了colorPrimaryDark这样的样式属性，状态栏颜色默认会使用colorPrimaryDark的颜色，同时通过support包，这种能力也可以兼容到5.0以下。
</p>

<p>
但是却又带来了另外一个问题，如果状态栏颜色设置的是浅色的，比如白色，那么状态栏上的文字和图标就会完全看不见，但是又无法改变状态栏文字和图标的颜色，这个问题到Android 6.0得到了解决。
</p>
</div>
</div>
<div id="outline-container-sec-1-3" class="outline-3">
<h3 id="sec-1-3"><span class="section-number-3">1.3</span> Android 6.0 （API 23）</h3>
<div class="outline-text-3" id="text-1-3">
<p>
支持直接设置状态栏颜色，同时支持设置状态栏文字和图标颜色设置为深色或者浅色。至此，全屏应用和非全屏应用对状态栏的需求基本上都可以满足了。
</p>
</div>
</div>
<div id="outline-container-sec-1-4" class="outline-3">
<h3 id="sec-1-4"><span class="section-number-3">1.4</span> 状态栏的最佳实践</h3>
<div class="outline-text-3" id="text-1-4">
</div><div id="outline-container-sec-1-4-1" class="outline-4">
<h4 id="sec-1-4-1"><span class="section-number-4">1.4.1</span> 需要全屏的APP</h4>
<div class="outline-text-4" id="text-1-4-1">
<p>
首先，需要确定背景内容一定是需要延伸到状态栏区域的，这意味着背景内容一定不是纯色的，如果是纯色完全可以通过设置状态栏颜色做到，这样可以避免计算布局高度等问题。如果不是纯色的，我们也就完全没必要再计算状态栏的高度了，因为计算高度只是为了不让状态栏遮挡内容。对于这种场景，4.4版本就足以处理了
</p>
<ol class="org-ol">
<li>style中windowTranslucentStatus设置为true
</li>
<li>根布局设置SYSTEM<sub>UI</sub><sub>FLAG</sub><sub>LAYOUT</sub><sub>FULLSCREEN和</sub>
       SYSTEM<sub>UI</sub><sub>FLAG</sub><sub>LAYOUT</sub><sub>STABLE标志位</sub>
</li>
</ol>
</div>
</div>
<div id="outline-container-sec-1-4-2" class="outline-4">
<h4 id="sec-1-4-2"><span class="section-number-4">1.4.2</span> 只需要纯色状态栏的APP</h4>
<div class="outline-text-4" id="text-1-4-2">
<p>
这种是不需要将背景内容延伸到状态栏区域的。
</p>
<ol class="org-ol">
<li>如果是浅色状态栏，那就不要折腾兼容5.0及以下了，即使改变了状态栏的颜色，也会无法解决看不清状态栏上面内容的问题。
<ul class="org-ul">
<li>4.4及以下系统默认就好，状态栏黑底白字
</li>
<li>5.0及以下设置有辨识度的colorPrimaryDark，并且能和背景色配合的好看一些，能比4.4的体验好一点点
</li>
<li>6.0及以上，直接设置状态栏颜色，同时设置
SYSTEM<sub>UI</sub><sub>FLAG</sub><sub>LIGHT</sub><sub>STATUS</sub><sub>BAR，使状态栏内容为深色。</sub>
</li>
</ul>
</li>
<li>如果是深色状态栏，5.0的效果可以更好一些。
<ul class="org-ul">
<li>4.4及以下系统默认就好，状态栏黑底白字
</li>
<li>5.0及以上将colorPrimaryDark设置为想要的颜色
</li>
</ul>
</li>
</ol>
</div>
</div>
</div>
</div>

  </div><!-- /.entry-content -->
  <footer class="post-info-footer">
        Category: <a href="http://www.iknockdoor.com/category/misc.html"><span>misc</span></a>
  </footer>
</section>
        </div>
        <footer id="contentinfo" class="body">
          © 2017-2020 iknockdoor</address><!-- /#about -->
        </footer><!-- /#contentinfo -->
</body>
</html>